function createCookie(name,value,days){var expires='';if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires='; expires='+date.toGMTString();}else{expires='';}
document.cookie=name+'='+value+expires+'; path=/';}
function readCookie(name){var nameEQ=name+'=';var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1,c.length);}
if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length);}}
return null;}
function submitRatings(element){var hasError='',parentContainer=element,criterionContainer=parentContainer.find('.gpur-criterion'),inputField=parentContainer.find('.gpur-criterion .gpur-user-rating'),nonce=inputField.data('nonce'),minRating=inputField.data('min-rating'),maxRating=inputField.data('stop'),count=1,eachRatingValue=0,ratingValue=0,multiRatingValues=[];if(!inputField.hasClass('gpur-comment-rating')){if(readCookie('gpur_user_rating_'+gpur_add_user_ratings.post_id)||gpur_add_user_ratings.userRating){hasError='yes';}}
if(hasError!='yes'){criterionContainer.each(function(index){count=parseInt(index+1);var inputField=jQuery(this).find('.gpur-user-rating'),weight=inputField.data('weight');if(weight!==undefined&&weight!==''){eachRatingValue+=parseFloat(inputField.val()*weight);}else{eachRatingValue+=parseFloat(inputField.val());}
multiRatingValues[index]=inputField.val();if(multiRatingValues[index]===''&&minRating===0){multiRatingValues[index]=0;}
if(multiRatingValues[index]<minRating){multiRatingValues[index]=0;}
if(multiRatingValues[index]>maxRating){multiRatingValues[index]=maxRating;}
if(!jQuery.isNumeric(multiRatingValues[index])){hasError='yes';return false;}});var avgRatingValue=parseFloat(eachRatingValue/count);ratingValue=Math.round(avgRatingValue*10)/10;}
parentContainer.find('.gpur-success').hide();parentContainer.find('.gpur-error').hide();if(!inputField.hasClass('gpur-comment-rating')){parentContainer.addClass('gpur-loading');}
if(hasError!='yes'){inputField.attr('data-readonly','');var data={action:'gpur_save_rating',postID:gpur_add_user_ratings.post_id,nonce:nonce,maxRating:maxRating,minRating:minRating,ratingValue:ratingValue,multiRatingValues:multiRatingValues};jQuery.post(gpur_add_user_ratings.ajax_url,data,function(){if(!jQuery('body').hasClass('logged-in')){if(multiRatingValues!=''){createCookie('gpur_user_rating_'+gpur_add_user_ratings.post_id,multiRatingValues,900);}else{createCookie('gpur_user_rating_'+gpur_add_user_ratings.post_id,ratingValue,900);}}});setTimeout(function(){parentContainer.find('.gpur-submit-rating').fadeOut();parentContainer.removeClass('gpur-loading');parentContainer.find('.gpur-success').css({opacity:0,display:'block'}).animate({opacity:1},600);},800);}else{setTimeout(function(){parentContainer.removeClass('gpur-loading');parentContainer.find('.gpur-error').css({opacity:0,display:'block'}).animate({opacity:1},600);},800);hasError='';}}
jQuery(function($){'use strict';var hasError='';var criterionWrapper=$('.gpur-style-bars .gpur-criterion');criterionWrapper.each(function(){var eachCriterionWrapper=$(this),barCount=$(this).find('.gpur-user-rating').data('stop'),barWidth=(100/barCount)+'%';eachCriterionWrapper.find('.rating-symbol').css('width',barWidth);});$('#gpur-comment-form-title').keyup(function(){var textlen=gpur_add_user_ratings.review_title_limit-$(this).val().length;$(this).next('.gpur-character-limit-message').find('.gpur-characters-remaining').text(textlen);});$('textarea#comment').keyup(function(){var textlen=gpur_add_user_ratings.review_text_limit-$(this).val().length;$(this).next('.gpur-character-limit-message').find('.gpur-characters-remaining').text(textlen);});$(document).on('rating.rateenter','.gpur-add-user-ratings-wrapper .rating-symbol',function(e,rate){var el=$(this),inputField=el.parent().parent().find('.gpur-user-rating');if(!inputField.hasClass('gpur-comment-rating')){if(readCookie('gpur_user_rating_'+gpur_add_user_ratings.post_id)||gpur_add_user_ratings.user_rating){hasError='yes';}}
if(hasError!='yes'){if(rate===''&&inputField.data('min-rating')===0){rate=0;}
if(rate<inputField.data('min-rating')){rate=inputField.data('min-rating');}
if(rate>inputField.data('stop')){rate=inputField.data('stop');}
el.parent().parent().find('.gpur-your-user-rating .gpur-rating-value').text(parseFloat(rate));}});$(document).on('rating.rateleave','.gpur-add-user-ratings-wrapper .rating-symbol',function(){var el=$(this),inputField=el.parent().parent().find('.gpur-user-rating');if(!inputField.hasClass('gpur-comment-rating')){if(readCookie('gpur_user_rating_'+gpur_add_user_ratings.post_id)||gpur_add_user_ratings.user_rating){hasError='yes';}}
if(hasError!='yes'){if(inputField.val()===0){el.parent().parent().find('.gpur-your-user-rating .gpur-rating-value').text(0);}else{el.parent().parent().find('.gpur-your-user-rating .gpur-rating-value').text(inputField.val());}}});$('.gpur-add-user-ratings-wrapper.gpur-multi-rating .rating-symbol').on('click',function(e){var el=$(this),inputField=el.parent().parent().find('.gpur-user-rating'),ratingText=el.parent().parent().find('.gpur-your-user-rating .gpur-rating-value');if(!inputField.hasClass('gpur-comment-rating')){if(readCookie('gpur_user_rating_'+gpur_add_user_ratings.post_id)||gpur_add_user_ratings.user_rating){hasError='yes';}}
if(hasError!='yes'){ratingText.text(parseFloat(inputField.val()));}});$('body').on('submit','#attachmentForm',function(){var commentform=$(this),action=commentform.attr('action'),formData=commentform.serializeArray(),titleField=commentform.find('#gpur-comment-form-title'),inputField=commentform.find('.gpur-user-rating'),author=commentform.find('#author'),email=commentform.find('#email'),commentField=commentform.find('#comment'),hasError='';var mintitle=titleField.val();var mincomment=commentField.val();var mincomment=commentField.val();var privacy=document.getElementById("privacy-value").checked
var focuson=[];var star=$('#starrate').val();if(star!=0){titleField.removeClass('gpur-required');if(titleField.val()===''){focuson.push('gpur-comment-form-title');hasError='yes';}
if(mintitle.length!=0)
{if(mintitle.length<=15)
{var mincourse="Please Enter review title minimum 15 characters long";$('#titlemin').text(mincourse).show();setTimeout(function(){$('#titlemin').hide();},5000);focuson.push('gpur-comment-form-title');hasError='yes';}}
$('#ratevalid').remove();if(inputField.val()==0)
{$('#ratevalid').remove();$('input[name="gpur_rating\[\]"]').after('<span id="ratevalid" style="color: red;font-size:12px;">*Required</span>');hasError='yes';focuson.push('author');}}
var userlog=$("#login-user").val();if(userlog!=1){author.removeClass('gpur-required');$('#authorvalid').remove();if(author.val()===''){focuson.push('author');hasError='yes';}
function checkString(strchar)
{var filter=/^[a-zA-Z]/;if(!filter.test(strchar)){$('#authorvalid').remove();$("input#author").after('<span id="authorvalid" style="color: red;font-size:12px;">The Name Entered is not Valid</span>');hasError='yes';focuson.push('author');}}
if(author.val()!='')
{checkString(author.val());}
email.removeClass('gpur-required');$('#emailvalid').remove();if(email.val()===''){focuson.push('email');hasError='yes';}
function checkEmail(mail){var filter=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;if(!filter.test(mail)){$('#emailvalid').remove();$("input#email").after('<span id="emailvalid" style="color: red;font-size:12px;">The E-mail Address Entered is not Valid </span>');hasError='yes';focuson.push('email');}}
if(email.val()!='')
{checkEmail(email.val());}}
commentField.removeClass('gpur-required');if(commentField.val()===''){hasError='yes';focuson.push('comment');}
if(mincomment.length!=0)
{if(mincomment.length<=180)
{var pcourse="Please Enter Your review minimum 180 characters long";$('#errormin').text(pcourse).show();setTimeout(function(){$('#errormin').hide();},5000);hasError='yes';focuson.push('comment');}}
$('#privacyvalid').remove();if(!privacy)
{$('#privacyvalid').remove();$("input#privacy-value").after('<span id="privacyvalid" style="color: red;font-size:12px;">*Required</span>');focuson.push('privacyvalid');hasError='yes';}
$('#'+focuson[0]).focus();for(var i=0;i<focuson.length;i++)
{$('#'+focuson[i]).addClass('gpur-required');}
commentform.find('.gpur-success').hide();commentform.find('.gpur-error').hide();commentform.addClass('gpur-loading');if(hasError==='yes'){setTimeout(function(){commentform.removeClass('gpur-loading');commentform.find('.gpur-error').text(gpur_add_user_ratings.comment_form_single_error_message).css({opacity:0,display:'block'}).animate({opacity:1},600);},800);return false;}});$('.gpur-in-post.gpur-add-user-ratings-wrapper.gpur-no-submit-button .rating-symbol').on('click',function(e){submitRatings($(this).parent().parent().parent());});$('.gpur-has-submit-button .gpur-submit-rating').on('click',function(e){submitRatings($(this).parent());});jQuery(document).ready(function($){$(".comment-reply-link").on("click",function(e){e.preventDefault(),$(".gpur-add-user-ratings-wrapper").hide(),$(".gpur-comment-form-title").hide(),$(".comment-form-attachment").hide(),$(".comentlink").hide(),$("#starrate").val("0")}),$("#cancel-comment-reply-link").on("click",function(e){e.preventDefault(),$(".gpur-add-user-ratings-wrapper").show(),$(".gpur-comment-form-title").show(),$(".comment-form-attachment").show(),$(".comentlink").show(),$("#starrate").val("1")});});});